<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoForkå°å…¥åŠ¹æœ ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ | æ ªå¼ä¼šç¤¾ãƒã‚¯ã‚ªã‚¦ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .presentation-container {
            display: flex;
            width: 100%;
            height: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }
        .slide {
            flex: 0 0 100vw;
            width: 100vw;
            height: 100vh;
            scroll-snap-align: start;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 4vw;
            position: relative;
        }
        .slide-content {
            width: 100%;
            max-width: 1200px;
            margin: auto;
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        .gradient-text {
            background: linear-gradient(to right, #ff6361, #bc5090);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .slide-number {
            position: absolute;
            bottom: 20px;
            right: 30px;
            font-size: 1rem;
            color: #9ca3af;
        }
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #bc5090;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="presentation-container">

        <!-- Slide 1: Title -->
        <section class="slide bg-white">
            <div class="slide-content text-center">
                <p class="text-2xl md:text-3xl text-gray-500">æ ªå¼ä¼šç¤¾ãƒã‚¯ã‚ªã‚¦ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹</p>
                <h1 class="text-5xl md:text-8xl font-black text-gray-800 mt-8 leading-tight">
                    è²´ç¤¾ã®å€‰åº«ã€<br>
                    <span class="gradient-text">æœ¬å½“ã®ã‚³ã‚¹ãƒˆ</span>ã‚’<br>
                    çŸ¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ
                </h1>
                <p class="mt-10 text-xl md:text-2xl text-gray-600 max-w-4xl mx-auto">
                    ã€Œäººã«ä¾å­˜ã—éãã‚‹ã€ã¨ã„ã†çµŒå–¶ãƒªã‚¹ã‚¯ã‹ã‚‰è§£æ”¾ã™ã‚‹ãŸã‚ã®ã€æ–°ã—ã„ã”ææ¡ˆã§ã™ã€‚
                </p>
            </div>
            <div class="slide-number">1 / 6</div>
        </section>

        <!-- Slide 2: The True Problem -->
        <section class="slide bg-gray-50">
            <div class="slide-content">
                <h2 class="text-5xl font-black text-center mb-10">æœ¬å½“ã®èª²é¡Œï¼šã€Œäººã¸ã®éå‰°ä¾å­˜ã€</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
                    <div class="bg-white rounded-2xl shadow-xl p-8 h-full">
                        <div class="text-center p-6 border-b-4 border-dashed border-sky-200">
                            <h3 class="text-2xl font-bold text-sky-600">è¦‹ãˆã¦ã„ã‚‹èª²é¡Œ</h3>
                            <div class="grid grid-cols-3 gap-4 mt-6 text-center">
                                <div><div class="text-5xl md:text-6xl">ğŸ‘¤</div><p class="mt-2 text-lg font-bold">äººæ‰‹ä¸è¶³</p></div>
                                <div><div class="text-5xl md:text-6xl">ğŸšš</div><p class="mt-2 text-lg font-bold">ç‰©æµå•é¡Œ</p></div>
                                <div><div class="text-5xl md:text-6xl">ğŸ’»</div><p class="mt-2 text-lg font-bold">DXåŒ–åœ§åŠ›</p></div>
                            </div>
                        </div>
                        <div class="text-center p-6 bg-sky-900/90 rounded-b-xl text-white">
                            <h3 class="text-2xl font-bold text-sky-200">æ°´é¢ä¸‹ã®æœ¬å½“ã®èª²é¡Œ</h3>
                            <p class="mt-4 text-3xl md:text-4xl font-black text-white leading-tight">åˆ©ç›Šã‚’è•ã‚€<br>ã€Œè¦‹ãˆãªã„ã‚³ã‚¹ãƒˆã€</p>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-2xl shadow-lg flex items-center">
                            <div class="w-1/3 h-24 p-2"><div class="chart-container"><canvas id="hiringCostChart"></canvas></div></div>
                            <div class="w-2/3 pl-4"><h3 class="text-2xl font-black text-[#003f5c]">â‘  æ¡ç”¨ã¨è‚²æˆã‚³ã‚¹ãƒˆ</h3><p class="mt-1 text-gray-600">æ±‚äººã€é¢æ¥ã€ç ”ä¿®...ã€‚é€€è·ã®åº¦ã«ç™ºç”Ÿã™ã‚‹ç´”ç²‹ãªæå¤±ã§ã™ã€‚</p></div>
                        </div>
                        <div class="bg-white p-4 rounded-2xl shadow-lg flex items-center">
                             <div class="w-1/3 h-24 p-2"><div class="chart-container"><canvas id="productivityCostChart"></canvas></div></div>
                            <div class="w-2/3 pl-4"><h3 class="text-2xl font-black text-[#bc5090]">â‘¡ ç”Ÿç”£æ€§ã®"ãƒ–ãƒ¬"ã‚³ã‚¹ãƒˆ</h3><p class="mt-1 text-gray-600">ç†Ÿç·´åº¦ã‚„ä½“èª¿ã«ã‚ˆã‚‹å‡¦ç†èƒ½åŠ›ã®å·®ãŒã€è¨ˆç”»ã®é…å»¶ã‚’ç”Ÿã¿ã¾ã™ã€‚</p></div>
                        </div>
                        <div class="bg-white p-4 rounded-2xl shadow-lg flex items-center">
                             <div class="w-1/3 h-24 p-2"><div class="chart-container"><canvas id="safetyCostChart"></canvas></div></div>
                            <div class="w-2/3 pl-4"><h3 class="text-2xl font-black text-[#ff6361]">â‘¢ å®‰å…¨ãƒ»ãƒªã‚¹ã‚¯ç®¡ç†ã‚³ã‚¹ãƒˆ</h3><p class="mt-1 text-gray-600">ç‰©æäº‹æ•…ã‚„åŠ´ç½ãƒªã‚¹ã‚¯ã¯ã€ä¼æ¥­ã®ä¿¡é ¼ã‚’æºã‚‹ãŒã™æ™‚é™çˆ†å¼¾ã§ã™ã€‚</p></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">2 / 6</div>
        </section>

        <!-- Slide 3: The Automation Trap & AutoFork's Answer -->
        <section class="slide bg-white">
            <div class="slide-content">
                <h2 class="text-5xl font-black text-center mb-10">ã€Œè‡ªå‹•åŒ–ã®ç½ ã€ã¨ AutoForkã ã‘ã®ç­”ãˆ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                    <div class="bg-red-50 p-8 rounded-2xl border-2 border-red-200">
                        <h3 class="text-3xl font-bold text-red-600 flex items-center"><span class="text-4xl mr-3">âš ï¸</span>è‡ªå‹•åŒ–ã®ç½ </h3>
                        <p class="mt-4 text-lg text-gray-700">ãŸã æ©Ÿæ¢°ã‚’å°å…¥ã™ã‚‹ã ã‘ã§ã¯ã€æ–°ãŸãªå•é¡ŒãŒç”Ÿã¾ã‚Œã¾ã™ã€‚<br>ã€ŒäººãŒæ©Ÿæ¢°ã«åˆã‚ã›ã‚‹ã€ã¨ã„ã†ã€èé€šã®åˆ©ã‹ãªã„ç¾å ´ã«ãªã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ</p>
                        <ul class="mt-6 space-y-4 text-lg">
                            <li class="flex items-start"><span class="text-red-500 mr-2 font-bold">Ã—</span>ãƒ‘ãƒ¬ãƒƒãƒˆã¯å¸¸ã«æ±ºã¾ã£ãŸå ´æ‰€ã«ã€æ­£ç¢ºã«ç½®ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„â€¦</li>
                            <li class="flex items-start"><span class="text-red-500 mr-2 font-bold">Ã—</span>ãƒ«ãƒ¼ãƒˆå¤‰æ›´ã®ãŸã³ã«ã€å¤–éƒ¨ã®æ¥­è€…ã‚’å‘¼ã¶å¿…è¦ãŒã‚ã‚‹â€¦</li>
                            <li class="flex items-start"><span class="text-red-500 mr-2 font-bold">Ã—</span>å°†æ¥ã®æ‹¡å¼µæ€§ãŒãªãã€ã‚·ã‚¹ãƒ†ãƒ ãŒé™³è…åŒ–ã—ã¦ã—ã¾ã†â€¦</li>
                        </ul>
                    </div>
                    <div class="bg-sky-50 p-8 rounded-2xl border-2 border-sky-200">
                        <h3 class="text-3xl font-bold text-sky-600 flex items-center"><span class="text-4xl mr-3">ğŸ’¡</span>AutoForkã®ç­”ãˆ</h3>
                        <p class="mt-4 text-lg text-gray-700">çœŸã®è§£æ±ºç­–ã¯ã€å˜ãªã‚‹è‡ªå‹•åŒ–ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>ã€Œä»Šã®ç¾å ´ã®ã‚„ã‚Šæ–¹ã«ã€æ©Ÿæ¢°ãŒåˆã‚ã›ã¦ãã‚Œã‚‹ã€ã‚¹ãƒãƒ¼ãƒˆãªè‡ªå‹•åŒ–ã§ã™ã€‚</p>
                        <ul class="mt-6 space-y-4 text-lg">
                            <li class="flex items-start"><span class="text-sky-500 mr-2 font-bold">â—</span><strong class="text-sky-700">äººãŒç½®ã„ãŸã€ãã®ã¾ã¾ã®å ´æ‰€ã‹ã‚‰ã€‚</strong><br>ä¸æ•´åˆ—ãªãƒ‘ãƒ¬ãƒƒãƒˆã‚‚è‡ªã‚‰èªè­˜ã—ã¾ã™ã€‚</li>
                            <li class="flex items-start"><span class="text-sky-500 mr-2 font-bold">â—</span><strong class="text-sky-700">PCä¸è¦ã€‚ç¾å ´ã®ã‚ãªãŸãŒã€ã™ãã«ã€‚</strong><br>ã‚ãªãŸè‡ªèº«ã®æ‰‹ã§æŸ”è»Ÿã«ãƒ«ãƒ¼ãƒˆã‚’å¤‰æ›´ã§ãã¾ã™ã€‚</li>
                            <li class="flex items-start"><span class="text-sky-500 mr-2 font-bold">â—</span><strong class="text-sky-700">æœªæ¥ã®æ‹¡å¼µã¾ã§ã€ç´„æŸã—ã¾ã™ã€‚</strong><br>ã‚ªãƒ¼ãƒ—ãƒ³ãªé€£æºã§ã€ã‚·ã‚¹ãƒ†ãƒ ãŒé€²åŒ–ã—ç¶šã‘ã¾ã™ã€‚</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="slide-number">3 / 6</div>
        </section>

        <!-- Slide 4: True ROI Combined -->
        <section class="slide bg-white">
            <div class="slide-content">
                <h2 class="text-5xl font-black text-center mb-4">çœŸã®è²»ç”¨å¯¾åŠ¹æœ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 h-[60vh]">
                    <div class="bg-white p-6 rounded-2xl shadow-lg flex flex-col"><h3 class="text-2xl font-bold text-center">å¹´é–“ç·ã‚³ã‚¹ãƒˆæ¯”è¼ƒ</h3><p class="text-center text-gray-500 mt-1 mb-4">ã€Œè¦‹ãˆãªã„ã‚³ã‚¹ãƒˆã€ã‚’åŠ ãˆã‚‹ã¨ã€å·®ã¯æ­´ç„¶ã§ã™ã€‚</p><div class="flex-grow"><div class="chart-container"><canvas id="annualCostChart"></canvas></div></div></div>
                    <div class="bg-white p-6 rounded-2xl shadow-lg flex flex-col"><h3 class="text-2xl font-bold text-center">ç´¯è¨ˆã‚³ã‚¹ãƒˆæ¨ç§» (6å¹´é–“)</h3><p class="text-center text-gray-500 mt-1 mb-4">æ•°å¹´ã§æŠ•è³‡ã‚’å›åã—ã€æœªæ¥ã®åˆ©ç›Šã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚</p><div class="flex-grow"><div class="chart-container"><canvas id="cumulativeCostChart"></canvas></div></div></div>
                </div>
                <div class="mt-4 text-center bg-gray-50 p-4 rounded-lg shadow-inner">
                    <p class="font-bold text-lg">âœ¨ AIã§è²´ç¤¾ã ã‘ã®ã‚³ã‚¹ãƒˆã‚’è©¦ç®—</p>
                    <div class="flex flex-wrap justify-center items-center gap-4 mt-2">
                        <div><label for="operators">ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼äººæ•°:</label><input id="operators" type="number" value="1" class="w-20 p-1 border rounded"> äºº</div>
                        <div><label for="salary">å¹³å‡å¹´å:</label><input id="salary" type="number" value="466" class="w-24 p-1 border rounded"> ä¸‡å††</div>
                        <div><label for="autoforkUnits" class="font-bold">AutoForkå°æ•°:</label><input id="autoforkUnits" type="number" value="1" class="w-20 p-1 border rounded font-bold"> å°</div>
                        <button id="simulateBtn" class="bg-gradient-to-r from-[#ff6361] to-[#bc5090] text-white font-bold py-2 px-6 rounded-lg shadow-md hover:shadow-lg transition">AIã§è©¦ç®—ã™ã‚‹ âœ¨</button>
                    </div>
                </div>
            </div>
            <div class="slide-number">4 / 6</div>
        </section>

        <!-- Slide 5: The Solution -->
        <section class="slide bg-gray-800 text-white">
            <div class="slide-content text-center">
                <h2 class="text-6xl font-black">è§£æ±ºç­–ã¯ã€AutoForkã§ã™ã€‚</h2>
                <p class="mt-6 text-xl text-gray-300 max-w-4xl mx-auto">AutoForkã¯å˜ãªã‚‹ã€Œäººã®ä»£æ›¿ã€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>è²´ç¤¾ã®å€‰åº«ã‚’ã€Œäººã«ä¾å­˜ã—éãã‚‹ä½“åˆ¶ã€ã‹ã‚‰è§£æ”¾ã—ã€ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ãŸå®‰å®šç¨¼åƒã‚’å®Ÿç¾ã™ã‚‹ã€æ–°ã—ã„çµŒå–¶ã‚¤ãƒ³ãƒ•ãƒ©ã§ã™ã€‚</p>
                <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-gray-700 p-8 rounded-xl"><div class="text-5xl">ğŸ”„</div><h3 class="text-2xl font-bold mt-4">äº‹æ¥­ã®ç¶™ç¶šæ€§</h3><p class="text-gray-400 mt-2">é•·æ™‚é–“ã€è¨ˆç”»é€šã‚Šã«å®‰å®šç¨¼åƒã€‚ä¸æ¸¬ã®äº‹æ…‹ã§ã‚‚ç‰©æµã‚’æ­¢ã‚ã¾ã›ã‚“ã€‚</p></div>
                    <div class="bg-gray-700 p-8 rounded-xl"><div class="text-5xl">ğŸ“Š</div><h3 class="text-2xl font-bold mt-4">ãƒ‡ãƒ¼ã‚¿çµŒå–¶ã®å®Ÿç¾</h3><p class="text-gray-400 mt-2">å…¨ã¦ã®ç¨¼åƒãƒ‡ãƒ¼ã‚¿ã‚’è“„ç©ãƒ»åˆ†æã—ã€ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³å…¨ä½“ã®æœ€é©åŒ–ã«è²¢çŒ®ã—ã¾ã™ã€‚</p></div>
                    <div class="bg-gray-700 p-8 rounded-xl"><div class="text-5xl">ğŸ“ˆ</div><h3 class="text-2xl font-bold mt-4">ä¼æ¥­ä¾¡å€¤ã®å‘ä¸Š</h3><p class="text-gray-400 mt-2">äººã«ä¾å­˜ã—ãªã„ä½“åˆ¶ã¯ã€æŠ•è³‡å®¶ã‹ã‚‰é«˜ãè©•ä¾¡ã•ã‚Œã€æœªæ¥ã®æˆé•·ã‚’åŠ é€Ÿã•ã›ã¾ã™ã€‚</p></div>
                </div>
            </div>
            <div class="slide-number">5 / 6</div>
        </section>

        <!-- Slide 6: Call to Action -->
        <section class="slide bg-white">
            <div class="slide-content text-center">
                <h2 class="text-5xl md:text-6xl font-black text-gray-800">å›½éš›ç‰©æµå±•ã§ã€<br>æœªæ¥ã®å€‰åº«ã‚’ã€‚</h2>
                <p class="mt-6 text-xl md:text-2xl text-gray-600">3å°é€£æºãƒ‡ãƒ¢ã§ã€Œäººã«ä¾å­˜ã—ãªã„ã€æœªæ¥ã®ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã”ä½“æ„Ÿãã ã•ã„ã€‚</p>
                <div class="mt-10 text-center bg-gray-50 p-4 rounded-lg shadow-inner max-w-2xl mx-auto">
                    <p class="font-bold text-lg">âœ¨ AIã§è²´ç¤¾ã®æœªæ¥ã‚’äºˆæ¸¬</p>
                    <div class="flex justify-center items-center gap-4 mt-2">
                        <div><label for="industry">è²´ç¤¾ã®æ¥­ç¨®:</label><input id="industry" type="text" placeholder="ä¾‹ï¼šé£Ÿå“å¸å£²æ¥­" class="w-48 p-1 border rounded"></div>
                        <button id="visionBtn" class="bg-gradient-to-r from-[#58508d] to-[#003f5c] text-white font-bold py-2 px-6 rounded-lg shadow-md hover:shadow-lg transition">æœªæ¥ã‚’äºˆæ¸¬ã™ã‚‹ âœ¨</button>
                    </div>
                </div>
                <p class="mt-12 text-2xl text-gray-500 font-bold">æ ªå¼ä¼šç¤¾ãƒã‚¯ã‚ªã‚¦ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹</p>
            </div>
            <div class="slide-number">6 / 6</div>
        </section>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div id="modal-header" class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-2xl font-bold"></h3>
                <button id="closeModalBtn" class="text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <div id="modal-body"></div>
            <div id="modal-footer" class="mt-6 text-right"></div>
        </div>
    </div>

    <script>
        let hiringCostChart, productivityCostChart, safetyCostChart, annualCostChart, cumulativeCostChart;
        
        const costData = {
            vehicle: 10000000,
            setup: 900000,
            licensePerUnit: 1440000,
            inspectionPerUnit: 150000,
            manualForkliftAnnualCost: 526667,
        };
        costData.runningPerUnit = costData.licensePerUnit + costData.inspectionPerUnit;

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) { return label.join(' '); }
            return label;
        };

        const formatCurrency = (value) => {
            if (Math.abs(value) >= 10000) { return Math.round(value / 10000) + 'ä¸‡å††'; }
            return value.toLocaleString() + 'å††';
        };

        const chartColors = {
            color1: '#003f5c', color2: '#58508d', color3: '#bc5090',
            color4: '#ff6361', color5: '#ffa600',
        };

        Chart.register(ChartDataLabels);

        const createDonutChart = (ctx, label, data, color) => {
            return new Chart(ctx, {
                type: 'doughnut', data: { labels: [label, ''], datasets: [{ data: data, backgroundColor: [color, '#e5e7eb'], borderColor: '#ffffff', borderWidth: 2, }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { display: false }, tooltip: { callbacks: { title: tooltipTitleCallback, label: (context) => `${context.label}: ${formatCurrency(context.raw)}` } }, datalabels: { display: false } } }
            });
        };

        const createAnnualCostChart = (ctx, conventionalDirect, conventionalInvisible, autoforkAverage) => {
            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['å¾“æ¥ã®æ–¹æ³•', 'AutoFork (6å¹´å¹³å‡)'],
                    datasets: [
                        { label: 'ç›´æ¥ã‚³ã‚¹ãƒˆ', data: [conventionalDirect, 0], backgroundColor: chartColors.color2 },
                        { label: 'è¦‹ãˆãªã„ã‚³ã‚¹ãƒˆ', data: [conventionalInvisible, 0], backgroundColor: chartColors.color4 },
                        { label: 'AutoFork ã‚³ã‚¹ãƒˆ', data: [0, autoforkAverage], backgroundColor: chartColors.color5 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { x: { stacked: true }, y: { stacked: true, ticks: { callback: (value) => formatCurrency(value) } } },
                    plugins: {
                        tooltip: { callbacks: { title: tooltipTitleCallback, label: (context) => `${context.dataset.label}: ${formatCurrency(context.raw)}` } },
                        datalabels: {
                            color: 'white',
                            font: { weight: 'bold', size: 14 },
                            formatter: (value) => value > 0 ? formatCurrency(value) : ''
                        }
                    }
                }
            });
        };

        const createCumulativeCostChart = (ctx, conventionalTotal, autoforkUnits) => {
            const conventionalCosts = Array.from({length: 6}, (_, i) => conventionalTotal * (i + 1));
            
            const autoforkInitial = (costData.vehicle * autoforkUnits) + costData.setup;
            const autoforkRunning = costData.runningPerUnit * autoforkUnits;
            const autoforkCosts = Array.from({length: 6}, (_, i) => autoforkInitial + (autoforkRunning * (i + 1)));
            
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['1å¹´ç›®', '2å¹´ç›®', '3å¹´ç›®', '4å¹´ç›®', '5å¹´ç›®', '6å¹´ç›®'],
                    datasets: [
                        { label: 'å¾“æ¥ã®æ–¹æ³• (ç·ã‚³ã‚¹ãƒˆ)', data: conventionalCosts, borderColor: chartColors.color4, backgroundColor: chartColors.color4 + '33', fill: true, tension: 0.1 },
                        { label: 'AutoFork (ç´¯è¨ˆã‚³ã‚¹ãƒˆ)', data: autoforkCosts, borderColor: chartColors.color1, backgroundColor: chartColors.color1 + '33', fill: true, tension: 0.1 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    layout: {
                        padding: {
                            right: 30 
                        }
                    },
                    scales: { y: { ticks: { callback: (value) => formatCurrency(value) } } },
                    plugins: {
                        tooltip: { callbacks: { title: tooltipTitleCallback, label: (context) => `${context.dataset.label}: ${formatCurrency(context.raw)}` } },
                        datalabels: {
                            align: 'top',
                            anchor: 'end',
                            offset: 4,
                            color: (context) => context.dataset.borderColor,
                            font: { weight: 'bold', size: 11 },
                            formatter: (value, context) => context.dataIndex === context.chart.data.labels.length - 1 ? formatCurrency(value) : ''
                        }
                    }
                }
            });
        };

        document.addEventListener('DOMContentLoaded', () => {
            hiringCostChart = createDonutChart(document.getElementById('hiringCostChart')?.getContext('2d'), 'æ¡ç”¨ãƒ»è‚²æˆã‚³ã‚¹ãƒˆ', [700000, 4663680], chartColors.color1);
            productivityCostChart = createDonutChart(document.getElementById('productivityCostChart')?.getContext('2d'), 'ç”Ÿç”£æ€§ãƒ–ãƒ¬ã‚³ã‚¹ãƒˆ', [470000, 4663680], chartColors.color3);
            safetyCostChart = createDonutChart(document.getElementById('safetyCostChart')?.getContext('2d'), 'å®‰å…¨ãƒ»ãƒªã‚¹ã‚¯ã‚³ã‚¹ãƒˆ', [230000, 4663680], chartColors.color4);
            
            const initialConventionalDirect = 4663680 + costData.manualForkliftAnnualCost;
            const initialConventionalInvisible = 700000 + 470000 + 230000;
            const initialAutoforkInitial = costData.vehicle + costData.setup;
            const initialAutoforkRunning = costData.runningPerUnit;
            const initialAutofork6YearTotal = initialAutoforkInitial + (initialAutoforkRunning * 6);
            const initialAutoforkAverage = initialAutofork6YearTotal / 6;

            annualCostChart = createAnnualCostChart(document.getElementById('annualCostChart')?.getContext('2d'), initialConventionalDirect, initialConventionalInvisible, initialAutoforkAverage);
            cumulativeCostChart = createCumulativeCostChart(document.getElementById('cumulativeCostChart')?.getContext('2d'), initialConventionalDirect + initialConventionalInvisible, 1);
        });

        const modal = document.getElementById('modal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');

        const showModal = (title, content) => {
            modalTitle.innerText = title;
            modalBody.innerHTML = content;
            modal.classList.remove('hidden');
        };
        const hideModal = () => modal.classList.add('hidden');
        closeModalBtn.addEventListener('click', hideModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) hideModal(); });

        const callApiEndpoint = async (endpoint, body) => {
             showModal("AIå‡¦ç†ä¸­...", '<div class="flex justify-center items-center"><div class="loader"></div></div>');
            try {
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ error: "ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”ãŒä¸æ­£ã§ã™ã€‚" }));
                    throw new Error(errorData.error || `ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ (ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${response.status})`);
                }
                return await response.json();
            } catch (error) {
                console.error("API call failed:", error);
                showModal("ã‚¨ãƒ©ãƒ¼", `<p>${error.message}</p>`);
                return null;
            }
        };

        const simulateBtn = document.getElementById('simulateBtn');
        simulateBtn.addEventListener('click', async () => {
            const operators = document.getElementById('operators').value;
            const salary = document.getElementById('salary').value * 10000;
            const autoforkUnits = document.getElementById('autoforkUnits').value;
            
            if (!operators || !salary || !autoforkUnits || operators <= 0 || salary <= 0 || autoforkUnits <= 0) {
                showModal("å…¥åŠ›ã‚¨ãƒ©ãƒ¼", "<p>æœ‰åŠ¹ãªæ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>");
                return;
            }

            const result = await callApiEndpoint('/api/simulate', { operators, salary });

            if (result) {
                const salaryCost = salary * operators;
                const manualForkliftCost = costData.manualForkliftAnnualCost * operators;
                const directCost = salaryCost + manualForkliftCost;
                const invisibleCost = result.hiringCost + result.productivityLoss + result.safetyRiskCost;
                const totalConventionalCost = directCost + invisibleCost;

                const autoforkInitial = (costData.vehicle * autoforkUnits) + costData.setup;
                const autoforkRunning = costData.runningPerUnit * autoforkUnits;
                const autofork6YearTotal = autoforkInitial + (autoforkRunning * 6);
                const autoforkAverage = autofork6YearTotal / 6;

                // Update Donut Charts
                hiringCostChart.data.datasets[0].data = [result.hiringCost, salaryCost];
                hiringCostChart.update();
                productivityCostChart.data.datasets[0].data = [result.productivityLoss, salaryCost];
                productivityCostChart.update();
                safetyCostChart.data.datasets[0].data = [result.safetyRiskCost, salaryCost];
                safetyCostChart.update();

                // Update Bar and Line Charts
                annualCostChart.data.datasets[0].data[0] = directCost;
                annualCostChart.data.datasets[1].data[0] = invisibleCost;
                annualCostChart.data.datasets[2].data[1] = autoforkAverage;
                annualCostChart.update();

                const newConventionalCosts = Array.from({length: 6}, (_, i) => totalConventionalCost * (i + 1));
                const newAutoforkCosts = Array.from({length: 6}, (_, i) => autoforkInitial + (autoforkRunning * (i + 1)));
                cumulativeCostChart.data.datasets[0].data = newConventionalCosts;
                cumulativeCostChart.data.datasets[1].data = newAutoforkCosts;
                cumulativeCostChart.update();
                
                const companyName = "è²´ç¤¾";
                const modalContent = `
                    <p class="mb-4">ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼${operators}åã€å¹³å‡å¹´å${formatCurrency(salary)}ã€AutoFork ${autoforkUnits}å°ã®å ´åˆã®AIã«ã‚ˆã‚‹è©¦ç®—çµæœã§ã™ã€‚</p>
                    <ul class="list-disc pl-5 space-y-2">
                        <li><strong>å¾“æ¥ä½“åˆ¶ã®å¹´é–“ç·ã‚³ã‚¹ãƒˆï¼ˆæ¦‚ç®—ï¼‰:</strong> <span class="font-bold">${formatCurrency(totalConventionalCost)}</span></li>
                        <li><strong>AutoForkã®6å¹´å¹³å‡ã‚³ã‚¹ãƒˆ:</strong> <span class="font-bold">${formatCurrency(autoforkAverage)}</span></li>
                    </ul>
                    <p class="mt-4 text-sm text-gray-600">â€»ã™ã¹ã¦ã®ã‚°ãƒ©ãƒ•ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚</p>
                `;
                showModal(`âœ¨ AIã«ã‚ˆã‚‹ã‚³ã‚¹ãƒˆåˆ†æçµæœ`, modalContent);
            }
        });

        const visionBtn = document.getElementById('visionBtn');
        visionBtn.addEventListener('click', async () => {
            const industry = document.getElementById('industry').value;
            if (!industry) {
                showModal("å…¥åŠ›ã‚¨ãƒ©ãƒ¼", "<p>æ¥­ç¨®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>");
                return;
            }
            
            const result = await callApiEndpoint('/api/vision', { industry });

            if (result && result.vision) {
                const modalContent = `<p class="text-lg leading-relaxed">${result.vision.replace(/\n/g, '<br>')}</p>`;
                showModal(`âœ¨ ${industry}ã®5å¹´å¾Œã®å€‰åº«ãƒ“ã‚¸ãƒ§ãƒ³`, modalContent);
            }
        });
    </script>
</body>
</html>

